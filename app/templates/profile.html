{% extends "base.html" %} {% block main %}

<div class="content">
  <div class="banner centre">
    <form
        action="{{ url_for('profile') }}"
        method="POST"
        enctype="multipart/form-data"
    >
      <div> {{ uploadForm.csrf_token }}
        <div>
          {% if username == session['username'] %} 
            {% if profile_picture != None %} 
            <img
            src="{{ url_for('static', filename='uploads/' + profile_picture[1]) }}"
            class="propic mt-5 mb-3 relative" width="180"
              height="180"
              /> 
              {% endif %}
            {% endif %}

          {% if username != session['username'] %} 
            {% if friend_profile_picture != None %} 
            <img
            src="{{ url_for('static', filename='uploads/' + friend_profile_picture[1]) }}"
            class="propic mt-5 mb-3 relative" width="180"
              height="180"
              /> 
              {% endif %}
              {% if friend_profile_picture == None %} 
              <img src="../static/icons/blank_user_profile.jpg" class="propic mt-5 mb-3 relative" width="180" height="180" />
              {% endif %}
            {% endif %}
            
            {% if profile_picture == None %} 
            <img class="propic mt-5 mb-3 relative" width="180" height="180" />
            {% endif %}
            {% if username == session['username'] %} 
            <div>
              <img
              class="absolute middle"
              src="../static/icons/plusSign.png"
              width="50"
              height="50"
              />
              {{ uploadForm.profPic(class='browse-hidden-profile')}}
            </div>
              <button type="submit" name="submit" class="post-btn">Post</button>
              {% endif %}
              </div>
      </div>
    </form>

    <div class="profileName mb-3">{{username}}</div>
  </div>

  <!-- PROFILE OF NON FRIENDS -->
  <!-- <div class = "mycard posts centre pt-0">   
        <button class = "work-btn mr-1">
            Work
        </button>

        <button class = "rel-btn mr-1">
            Relative
        </button>

        <button class = "skl-btn">
            School
        </button>
 
        <div>
            <div class ="alert alert-info mt-4">
                Must be a friend to view posts
            </div>
        </div>
    </div>
     -->

  <!-- PROFILE OF USER -->
  <div class="posts">
    <div class="mycard centre relative pb-0 mb-5">
      {% if username == session['username'] %} 
      <form
        action="{{ url_for('profile') }}"
        method="POST"
        enctype="multipart/form-data"
      >
        {{ npost.csrf_token }} {{ npost.description(class='form-control post',
        placeholder = "Create new post..") }}

        <div class="sleeve">
          <span class="sleeve-title">Browse ...</span>
          {{ npost.photo(class='browse-hidden')}}
        </div>

        <button type="submit" name="submit" class="post-btn ml-0">Post</button>
      </form>
      {% endif %}
    </div>

    <!-- WHEN THERE ARE NO POSTS -->
    {% if posts == [] %}
    <div class ="alert alert-info">
            {{username}} currently has no posts
    </div> 
    {% endif %}
    
    <!-- WHEN THERE ARE POSTS -->
    {% for post in posts %} 
    <div class="mycard mb-5">
      <div class="thumbnail-pic"></div>
      <div class="post-title">
        {% if username == session['username'] %} 
        <span class="post-name ml-2">You</span> <a href=""><img src="../static/icons/pencil.png" class="pencil ml-2" /></a>
        <br />
        <span class="post-time ml-2">Posted on {{post[1]}} </span>
        {% endif %}
        {% if username != session['username'] %} 
        <span class="post-name ml-2">{{username}}</span> <br />
        <span class="post-time ml-2">Posted on {{post[1]}} </span>
        {% endif %}
      </div>

      <hr />

      <div class="centre">
        <p>{{ post[2] }}</p>
        {% if post[3] != None %} 
        <img
            src="{{ url_for('static', filename='uploads/' + post[3]) }}"
          class="img-block mt-2"
        /> {% endif %}
      </div>
      {% if session['username'] != username %} 
      <div class="mt-4"></div>
      <div class="mycard centre relative pb-0 mb-5">
        <form
          action="{{ url_for('profile') }}"
          method="POST"
          enctype="multipart/form-data"
        >
          {{ friend_post.csrf_token }} {{ friend_post.description(class='form-control post',
          placeholder = "Comment on post..") }}

  
          <button type="submit" name="submit" class="post-btn ml-0">Post</button>
        </form>
      </div>
      {% endif %}
    </div>
    {% endfor %}

    </div>
  </div>
</div>
{% endblock %}
